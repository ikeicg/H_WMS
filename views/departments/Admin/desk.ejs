<link rel="stylesheet" href="/css/desk4.css">

<div id="adm-div">

    <div class="sect-div metrics">

        <div class="sect-head">Today's Performance Metrics</div>

        <div class="dept-section">

            <% departments.forEach(x => {  if (x.name != 'Admin'){%>
                <% 

                    let valid = false
                    let datestamp = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate()).getTime();
                    let elmt = []
                    if(x.metrics.length >= 1){
                        elmt = x.metrics[x.metrics.length - 1];
                        if(elmt[0] == datestamp){
                            valid = true;
                        }
                    }

                %>

                <% if (valid){ %>
                    <div class="dept">
                        <p class="dept-name"><span class="d-label"><%= x.name %></span></p>
                        <p class="tTime"><span class="d-label">Turnaround Time: </span><%= Math.ceil(elmt[1] / (1000 * 60) ) %> minutes</p>
                        <p class="s-cases"><span class="d-label"> Serviced Cases: </span> <%= elmt[2] %></p>
                        <p class="tot-cases"> <span class="d-label">Queued Cases: </span> <%= x.cases.length %> </p>
                    </div>        
                <% } else { %>
                    <div class="dept">
                        <p class="dept-name"><span class="d-label"><%= x.name %></span></p>
                        <p class="tTime"><span class="d-label">Turnaround Time: </span> Nil </p>
                        <p class="s-cases"><span class="d-label"> Serviced Cases: </span> Nil </p>
                        <p class="tot-cases"> <span class="d-label">Queued Cases: </span> <%= x.cases.length %> </p>
                    </div>        
               <% } %>

            <% }}) %>

            
        </div>

    </div>

</div>
